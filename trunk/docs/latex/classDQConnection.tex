\hypertarget{classDQConnection}{
\section{DQConnection Class Reference}
\label{classDQConnection}\index{DQConnection@{DQConnection}}
}


Connection to QSqlDatabase.  




{\ttfamily \#include $<$dqconnection.h$>$}

\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\hypertarget{classDQConnection_a00bf59c9ec282de950ec56165c21bb05}{
\hyperlink{classDQConnection_a00bf59c9ec282de950ec56165c21bb05}{DQConnection} ()}
\label{classDQConnection_a00bf59c9ec282de950ec56165c21bb05}

\begin{DoxyCompactList}\small\item\em Constructs a new DQConnetion object. \item\end{DoxyCompactList}\item 
\hypertarget{classDQConnection_a421ee145e39ab42e720b6717baab0599}{
\hyperlink{classDQConnection_a421ee145e39ab42e720b6717baab0599}{DQConnection} (const \hyperlink{classDQConnection}{DQConnection} \&other)}
\label{classDQConnection_a421ee145e39ab42e720b6717baab0599}

\begin{DoxyCompactList}\small\item\em Constructs a \hyperlink{classDQConnection}{DQConnection} which is the reference to other. \item\end{DoxyCompactList}\item 
\hypertarget{classDQConnection_a3ced9cdd2515210bad1ff79303ddbb4a}{
\hyperlink{classDQConnection}{DQConnection} \& \hyperlink{classDQConnection_a3ced9cdd2515210bad1ff79303ddbb4a}{operator=} (const \hyperlink{classDQConnection}{DQConnection} \&other)}
\label{classDQConnection_a3ced9cdd2515210bad1ff79303ddbb4a}

\begin{DoxyCompactList}\small\item\em Refer to other \hyperlink{classDQConnection}{DQConnection} and returns a reference to this \hyperlink{classDQConnection}{DQConnection}. \item\end{DoxyCompactList}\item 
\hypertarget{classDQConnection_ad961748eeb7d068b8d491afedb7f7751}{
\hyperlink{classDQConnection_ad961748eeb7d068b8d491afedb7f7751}{$\sim$DQConnection} ()}
\label{classDQConnection_ad961748eeb7d068b8d491afedb7f7751}

\begin{DoxyCompactList}\small\item\em Destructor. \item\end{DoxyCompactList}\item 
bool \hyperlink{classDQConnection_abf0160a423e8a4726ec1867a8fb0ef3b}{operator==} (const \hyperlink{classDQConnection}{DQConnection} \&rhs)
\begin{DoxyCompactList}\small\item\em Operator== overloadig. \item\end{DoxyCompactList}\item 
bool \hyperlink{classDQConnection_af610030a87760d9c230ac15958858ef9}{operator!=} (const \hyperlink{classDQConnection}{DQConnection} \&rhs)
\begin{DoxyCompactList}\small\item\em Operator != overloadig. \item\end{DoxyCompactList}\item 
\hypertarget{classDQConnection_a866ec3798eec9615bbdf491664f6f14f}{
bool \hyperlink{classDQConnection_a866ec3798eec9615bbdf491664f6f14f}{open} (QSqlDatabase db)}
\label{classDQConnection_a866ec3798eec9615bbdf491664f6f14f}

\begin{DoxyCompactList}\small\item\em Open the connection to database. \item\end{DoxyCompactList}\item 
\hypertarget{classDQConnection_ab4508871169186c0a0c2d06cdec4ab37}{
void \hyperlink{classDQConnection_ab4508871169186c0a0c2d06cdec4ab37}{close} ()}
\label{classDQConnection_ab4508871169186c0a0c2d06cdec4ab37}

\begin{DoxyCompactList}\small\item\em Close the connection to database. \item\end{DoxyCompactList}\item 
\hypertarget{classDQConnection_a81e70c3514d30ac768eac6e4dcb37b35}{
bool \hyperlink{classDQConnection_a81e70c3514d30ac768eac6e4dcb37b35}{isOpen} ()}
\label{classDQConnection_a81e70c3514d30ac768eac6e4dcb37b35}

\begin{DoxyCompactList}\small\item\em Return TRUE if the database is opened,otherwise it is false. \item\end{DoxyCompactList}\item 
{\footnotesize template$<$typename T $>$ }\\bool \hyperlink{classDQConnection_a8f906b965a9fc69f898bb4a78ec9724c}{addModel} ()
\begin{DoxyCompactList}\small\item\em Add a model to the connection. \item\end{DoxyCompactList}\item 
\hypertarget{classDQConnection_a90471721101d30cfd35b2183d005ddcd}{
bool \hyperlink{classDQConnection_a90471721101d30cfd35b2183d005ddcd}{addModel} (\hyperlink{classDQModelMetaInfo}{DQModelMetaInfo} $\ast$metaInfo)}
\label{classDQConnection_a90471721101d30cfd35b2183d005ddcd}

\begin{DoxyCompactList}\small\item\em Add a model to the connection. \item\end{DoxyCompactList}\item 
\hypertarget{classDQConnection_a412eef8376c920d1e3f694e16617f9c0}{
void \hyperlink{classDQConnection_a412eef8376c920d1e3f694e16617f9c0}{setToDefaultConnection} ()}
\label{classDQConnection_a412eef8376c920d1e3f694e16617f9c0}

\begin{DoxyCompactList}\small\item\em Change this connection to be the default connection. \item\end{DoxyCompactList}\item 
bool \hyperlink{classDQConnection_a04d8bfa08e2f5e7c53961393215a4c96}{createTables} ()
\begin{DoxyCompactList}\small\item\em Run \char`\"{}create table\char`\"{} for all added model. \item\end{DoxyCompactList}\item 
\hypertarget{classDQConnection_a9bfe013a3ff6ac49b3e2db8aa2361282}{
bool \hyperlink{classDQConnection_a9bfe013a3ff6ac49b3e2db8aa2361282}{dropTables} ()}
\label{classDQConnection_a9bfe013a3ff6ac49b3e2db8aa2361282}

\begin{DoxyCompactList}\small\item\em Drop all the tables. \item\end{DoxyCompactList}\item 
\hypertarget{classDQConnection_a640c6c481f46b8725d8103cf3efcb9d1}{
bool \hyperlink{classDQConnection_a640c6c481f46b8725d8103cf3efcb9d1}{createIndex} (const \hyperlink{classDQBaseIndex}{DQBaseIndex} \&index)}
\label{classDQConnection_a640c6c481f46b8725d8103cf3efcb9d1}

\begin{DoxyCompactList}\small\item\em Create index. \item\end{DoxyCompactList}\item 
\hypertarget{classDQConnection_a7563ea3bb90a1a822d82d3ab5f52274c}{
bool {\bfseries dropIndex} (QString name)}
\label{classDQConnection_a7563ea3bb90a1a822d82d3ab5f52274c}

\item 
\hypertarget{classDQConnection_abfef4315ba931c8e3343a50954e5fb98}{
\hyperlink{classDQSql}{DQSql} \& \hyperlink{classDQConnection_abfef4315ba931c8e3343a50954e5fb98}{sql} ()}
\label{classDQConnection_abfef4315ba931c8e3343a50954e5fb98}

\begin{DoxyCompactList}\small\item\em Get the SQL interface that you may run predefined sql operations on the database. \item\end{DoxyCompactList}\item 
\hypertarget{classDQConnection_a86de58b5b1df1b046c0a8e71c80eadaf}{
QSqlQuery \hyperlink{classDQConnection_a86de58b5b1df1b046c0a8e71c80eadaf}{query} ()}
\label{classDQConnection_a86de58b5b1df1b046c0a8e71c80eadaf}

\begin{DoxyCompactList}\small\item\em Create a QSqlQuery object to the connected database. \item\end{DoxyCompactList}\item 
QSqlQuery \hyperlink{classDQConnection_a6fd8ad7aac33f470f32c3e308825ab8e}{lastQuery} ()
\begin{DoxyCompactList}\small\item\em The last query with error used by \hyperlink{classDQConnection}{DQConnection}. \item\end{DoxyCompactList}\item 
void \hyperlink{classDQConnection_aaa2cf5aea1936b578dac2f3b4676783a}{setLastQuery} (QSqlQuery query)
\end{DoxyCompactItemize}
\subsection*{Static Public Member Functions}
\begin{DoxyCompactItemize}
\item 
static \hyperlink{classDQConnection}{DQConnection} \hyperlink{classDQConnection_a95f1d7b3baf3c78e38c1f9e11ed71948}{defaultConnection} ()
\begin{DoxyCompactList}\small\item\em Get the default connection object. \item\end{DoxyCompactList}\end{DoxyCompactItemize}


\subsection{Detailed Description}
Connection to QSqlDatabase. DQuest is an ORM library , but it do not interact with database backend(e.g SQLite) directly. Instead it just use Qt's own database framework and provides the ORM wrapper interface over the framework.

In order to provide a more flexible way of operation, user have to create a QSqlDatabase by themself.

Then the \hyperlink{classDQConnection}{DQConnection} will hold the connection information to the QSqlDatabase instance. It will store all the supported model , and return a \hyperlink{classDQSql}{DQSql} object to this database for more advanced database operation.

\begin{DoxyRemark}{Remarks}
It is an explicitly shared class
\end{DoxyRemark}
Example code: 
\begin{DoxyCode}
int main(int argc, char *argv[])
{
    QCoreApplication a(argc, argv);

    // Open database using Qt library
    QSqlDatabase db = QSqlDatabase::addDatabase("QSQLITE");
    db.setDatabaseName( "your.db" );

    db.open();

    // Hold a connection to a database. It is needed before any database access u
      sing DQModel.
    DQConnection connection;

    connection.open(db); // Establish the connection to database. It will become 
      the "default connection" shared by all DQModel

    connection.addModel<User>(); // Register a model to the connection

    connection.createTables(); // Create table for all added model if it is not e
      xisted.

    // Your own code...

    connection.close(); // Please close the connection on quit.

    return 0;

}
\end{DoxyCode}
 

\subsection{Member Function Documentation}
\hypertarget{classDQConnection_a8f906b965a9fc69f898bb4a78ec9724c}{
\index{DQConnection@{DQConnection}!addModel@{addModel}}
\index{addModel@{addModel}!DQConnection@{DQConnection}}
\subsubsection[{addModel}]{\setlength{\rightskip}{0pt plus 5cm}template$<$typename T $>$ bool DQConnection::addModel (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}inline\mbox{]}}}}
\label{classDQConnection_a8f906b965a9fc69f898bb4a78ec9724c}


Add a model to the connection. 

\begin{DoxyReturn}{Returns}
TRUE if it is successful added. False if it is already added or the model is not delcared with DQ\_\-DECLARE\_\-MODEL 
\end{DoxyReturn}
\hypertarget{classDQConnection_a04d8bfa08e2f5e7c53961393215a4c96}{
\index{DQConnection@{DQConnection}!createTables@{createTables}}
\index{createTables@{createTables}!DQConnection@{DQConnection}}
\subsubsection[{createTables}]{\setlength{\rightskip}{0pt plus 5cm}bool DQConnection::createTables (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}
\label{classDQConnection_a04d8bfa08e2f5e7c53961393215a4c96}


Run \char`\"{}create table\char`\"{} for all added model. 

It will run \char`\"{}create table\char`\"{} for all added model if they are not existed. It will also call model's initialData() to retrieve the initial data and insert to database. \hypertarget{classDQConnection_a95f1d7b3baf3c78e38c1f9e11ed71948}{
\index{DQConnection@{DQConnection}!defaultConnection@{defaultConnection}}
\index{defaultConnection@{defaultConnection}!DQConnection@{DQConnection}}
\subsubsection[{defaultConnection}]{\setlength{\rightskip}{0pt plus 5cm}{\bf DQConnection} DQConnection::defaultConnection (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily  \mbox{[}static\mbox{]}}}}
\label{classDQConnection_a95f1d7b3baf3c78e38c1f9e11ed71948}


Get the default connection object. 

Default connection is the first opened connection. Any \hyperlink{classDQConnection}{DQConnection} instance can become the default connection as long as it is the first one to call \hyperlink{classDQConnection_a866ec3798eec9615bbdf491664f6f14f}{open()}.

It is fine to call \hyperlink{classDQConnection_a95f1d7b3baf3c78e38c1f9e11ed71948}{defaultConnection()} before to open any connection. The result returned is still valid and usable after a connection is opened.

For example, 
\begin{DoxyCode}
        DQConnection d = defaultConnection();
        DQConnection c;

        qDebug() << d.isOpen(); // False , as it is not opened.

        c.open(database); // c become the default connection

        qDebug() << d.isOpen(); // The result will become true , both of "c" and 
      "d" are also the default connection.
\end{DoxyCode}
 \hypertarget{classDQConnection_a6fd8ad7aac33f470f32c3e308825ab8e}{
\index{DQConnection@{DQConnection}!lastQuery@{lastQuery}}
\index{lastQuery@{lastQuery}!DQConnection@{DQConnection}}
\subsubsection[{lastQuery}]{\setlength{\rightskip}{0pt plus 5cm}QSqlQuery DQConnection::lastQuery (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}
\label{classDQConnection_a6fd8ad7aac33f470f32c3e308825ab8e}


The last query with error used by \hyperlink{classDQConnection}{DQConnection}. 

\begin{DoxyRemark}{Remarks}
It is thread-\/safe function 
\end{DoxyRemark}
\hypertarget{classDQConnection_af610030a87760d9c230ac15958858ef9}{
\index{DQConnection@{DQConnection}!operator!=@{operator!=}}
\index{operator!=@{operator!=}!DQConnection@{DQConnection}}
\subsubsection[{operator!=}]{\setlength{\rightskip}{0pt plus 5cm}bool DQConnection::operator!= (
\begin{DoxyParamCaption}
\item[{const {\bf DQConnection} \&}]{ rhs}
\end{DoxyParamCaption}
)}}
\label{classDQConnection_af610030a87760d9c230ac15958858ef9}


Operator != overloadig. 

It will return TRUE if they do not share the same database \hypertarget{classDQConnection_abf0160a423e8a4726ec1867a8fb0ef3b}{
\index{DQConnection@{DQConnection}!operator==@{operator==}}
\index{operator==@{operator==}!DQConnection@{DQConnection}}
\subsubsection[{operator==}]{\setlength{\rightskip}{0pt plus 5cm}bool DQConnection::operator== (
\begin{DoxyParamCaption}
\item[{const {\bf DQConnection} \&}]{ rhs}
\end{DoxyParamCaption}
)}}
\label{classDQConnection_abf0160a423e8a4726ec1867a8fb0ef3b}


Operator== overloadig. 

It will return TRUE if they share the same database \hypertarget{classDQConnection_aaa2cf5aea1936b578dac2f3b4676783a}{
\index{DQConnection@{DQConnection}!setLastQuery@{setLastQuery}}
\index{setLastQuery@{setLastQuery}!DQConnection@{DQConnection}}
\subsubsection[{setLastQuery}]{\setlength{\rightskip}{0pt plus 5cm}void DQConnection::setLastQuery (
\begin{DoxyParamCaption}
\item[{QSqlQuery}]{ query}
\end{DoxyParamCaption}
)}}
\label{classDQConnection_aaa2cf5aea1936b578dac2f3b4676783a}
Set the last query The last query with error used by \hyperlink{classDQConnection}{DQConnection}  \begin{DoxyRemark}{Remarks}
It is thread-\/safe function 
\end{DoxyRemark}


The documentation for this class was generated from the following files:\begin{DoxyCompactItemize}
\item 
src/dqconnection.h\item 
src/dqconnection.cpp\end{DoxyCompactItemize}
